   1               		.file	"week_of_month.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   9               		.text
  10               	.Ltext0:
  83               	.global	week_of_month
  85               	week_of_month:
  86               		.stabd	46,0,0
   1:../freeRTOS750/lib_time/week_of_month.c **** /*
   2:../freeRTOS750/lib_time/week_of_month.c ****  * (c)2012 Michael Duane Rice All rights reserved.
   3:../freeRTOS750/lib_time/week_of_month.c ****  *
   4:../freeRTOS750/lib_time/week_of_month.c ****  * Redistribution and use in source and binary forms, with or without
   5:../freeRTOS750/lib_time/week_of_month.c ****  * modification, are permitted provided that the following conditions are
   6:../freeRTOS750/lib_time/week_of_month.c ****  * met:
   7:../freeRTOS750/lib_time/week_of_month.c ****  *
   8:../freeRTOS750/lib_time/week_of_month.c ****  * Redistributions of source code must retain the above copyright notice, this
   9:../freeRTOS750/lib_time/week_of_month.c ****  * list of conditions and the following disclaimer. Redistributions in binary
  10:../freeRTOS750/lib_time/week_of_month.c ****  * form must reproduce the above copyright notice, this list of conditions
  11:../freeRTOS750/lib_time/week_of_month.c ****  * and the following disclaimer in the documentation and/or other materials
  12:../freeRTOS750/lib_time/week_of_month.c ****  * provided with the distribution. Neither the name of the copyright holders
  13:../freeRTOS750/lib_time/week_of_month.c ****  * nor the names of contributors may be used to endorse or promote products
  14:../freeRTOS750/lib_time/week_of_month.c ****  * derived from this software without specific prior written permission.
  15:../freeRTOS750/lib_time/week_of_month.c ****  *
  16:../freeRTOS750/lib_time/week_of_month.c ****  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  17:../freeRTOS750/lib_time/week_of_month.c ****  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  18:../freeRTOS750/lib_time/week_of_month.c ****  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  19:../freeRTOS750/lib_time/week_of_month.c ****  * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
  20:../freeRTOS750/lib_time/week_of_month.c ****  * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
  21:../freeRTOS750/lib_time/week_of_month.c ****  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
  22:../freeRTOS750/lib_time/week_of_month.c ****  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
  23:../freeRTOS750/lib_time/week_of_month.c ****  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  24:../freeRTOS750/lib_time/week_of_month.c ****  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
  25:../freeRTOS750/lib_time/week_of_month.c ****  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
  26:../freeRTOS750/lib_time/week_of_month.c ****  * POSSIBILITY OF SUCH DAMAGE.
  27:../freeRTOS750/lib_time/week_of_month.c ****  */
  28:../freeRTOS750/lib_time/week_of_month.c **** 
  29:../freeRTOS750/lib_time/week_of_month.c **** /* $Id$ */
  30:../freeRTOS750/lib_time/week_of_month.c **** 
  31:../freeRTOS750/lib_time/week_of_month.c **** /*
  32:../freeRTOS750/lib_time/week_of_month.c **** 	Return the week of month, where 'base' represents the starting day.
  33:../freeRTOS750/lib_time/week_of_month.c **** 	In the USA, the week is generally considered to start on Sunday (base = 0),
  34:../freeRTOS750/lib_time/week_of_month.c **** 	while in Europe it is generally considered to be Monday (base = 1).
  35:../freeRTOS750/lib_time/week_of_month.c **** 
  36:../freeRTOS750/lib_time/week_of_month.c **** 	Return value ranges from 0 to 5.
  37:../freeRTOS750/lib_time/week_of_month.c **** */
  38:../freeRTOS750/lib_time/week_of_month.c **** 
  39:../freeRTOS750/lib_time/week_of_month.c **** #include <time.h>
  40:../freeRTOS750/lib_time/week_of_month.c **** 
  41:../freeRTOS750/lib_time/week_of_month.c **** uint8_t
  42:../freeRTOS750/lib_time/week_of_month.c **** week_of_month(const struct tm * timestruct, uint8_t base)
  43:../freeRTOS750/lib_time/week_of_month.c **** {
  88               	.LM0:
  89               	.LFBB1:
  90 0000 CF93      		push r28
  91 0002 DF93      		push r29
  92               	/* prologue: function */
  93               	/* frame size = 0 */
  94               	/* stack size = 2 */
  95               	.L__stack_usage = 2
  44:../freeRTOS750/lib_time/week_of_month.c **** 	int             first, n;
  45:../freeRTOS750/lib_time/week_of_month.c **** 
  46:../freeRTOS750/lib_time/week_of_month.c **** 	/* zero base the day of month */
  47:../freeRTOS750/lib_time/week_of_month.c **** 	n = timestruct->tm_mday - 1;
  97               	.LM1:
  98 0004 DC01      		movw r26,r24
  99 0006 1396      		adiw r26,3
 100 0008 2C91      		ld r18,X
 101 000a 1397      		sbiw r26,3
 102 000c 3327      		clr r19
 103 000e 27FD      		sbrc r18,7
 104 0010 3095      		com r19
 105 0012 F901      		movw r30,r18
 106 0014 3197      		sbiw r30,1
  48:../freeRTOS750/lib_time/week_of_month.c **** 
  49:../freeRTOS750/lib_time/week_of_month.c **** 	/* find the first base day of the month (start of week 1) */
  50:../freeRTOS750/lib_time/week_of_month.c **** 	first = 7 + n - timestruct->tm_wday + base;
 108               	.LM2:
 109 0016 2A5F      		subi r18,-6
 110 0018 3F4F      		sbci r19,-1
 111 001a 1496      		adiw r26,4
 112 001c 8C91      		ld r24,X
 113 001e 281B      		sub r18,r24
 114 0020 3109      		sbc r19,__zero_reg__
 115 0022 87FD      		sbrc r24,7
 116 0024 3395      		inc r19
 117 0026 260F      		add r18,r22
 118 0028 311D      		adc r19,__zero_reg__
  51:../freeRTOS750/lib_time/week_of_month.c **** 	first %= 7;
 120               	.LM3:
 121 002a C7E0      		ldi r28,lo8(7)
 122 002c D0E0      		ldi r29,0
 123 002e C901      		movw r24,r18
 124 0030 BE01      		movw r22,r28
 125 0032 0E94 0000 		call __divmodhi4
  52:../freeRTOS750/lib_time/week_of_month.c **** 
  53:../freeRTOS750/lib_time/week_of_month.c **** 	/* find days since the first week began */
  54:../freeRTOS750/lib_time/week_of_month.c **** 	n = n - first;
 127               	.LM4:
 128 0036 E81B      		sub r30,r24
 129 0038 F90B      		sbc r31,r25
  55:../freeRTOS750/lib_time/week_of_month.c **** 
  56:../freeRTOS750/lib_time/week_of_month.c **** 	/* if negative, we are in week 0 */
  57:../freeRTOS750/lib_time/week_of_month.c **** 	if (n < 0)
 131               	.LM5:
 132 003a F7FD      		sbrc r31,7
 133 003c 00C0      		rjmp .L3
  58:../freeRTOS750/lib_time/week_of_month.c **** 		return 0;
  59:../freeRTOS750/lib_time/week_of_month.c **** 
  60:../freeRTOS750/lib_time/week_of_month.c **** 	return n / 7 + 1;
 135               	.LM6:
 136 003e CF01      		movw r24,r30
 137 0040 BE01      		movw r22,r28
 138 0042 0E94 0000 		call __divmodhi4
 139 0046 862F      		mov r24,r22
 140 0048 8F5F      		subi r24,lo8(-(1))
 141 004a 00C0      		rjmp .L2
 142               	.L3:
  58:../freeRTOS750/lib_time/week_of_month.c **** 		return 0;
 144               	.LM7:
 145 004c 80E0      		ldi r24,0
 146               	.L2:
 147               	/* epilogue start */
  61:../freeRTOS750/lib_time/week_of_month.c **** 
  62:../freeRTOS750/lib_time/week_of_month.c **** }
 149               	.LM8:
 150 004e DF91      		pop r29
 151 0050 CF91      		pop r28
 152 0052 0895      		ret
 154               	.Lscope1:
 156               		.stabd	78,0,0
 158               	.Letext0:
 159               		.ident	"GCC: (GNU) 4.7.2"
DEFINED SYMBOLS
                            *ABS*:00000000 week_of_month.c
     /tmp/cciqoTUp.s:2      *ABS*:0000003e __SP_H__
     /tmp/cciqoTUp.s:3      *ABS*:0000003d __SP_L__
     /tmp/cciqoTUp.s:4      *ABS*:0000003f __SREG__
     /tmp/cciqoTUp.s:5      *ABS*:00000000 __tmp_reg__
     /tmp/cciqoTUp.s:6      *ABS*:00000001 __zero_reg__
     /tmp/cciqoTUp.s:85     .text:00000000 week_of_month

UNDEFINED SYMBOLS
__divmodhi4
